<?xml version="1.0" encoding="UTF-8"?>

<!--
 * See the NOTICE file distributed with this work for additional
 * information regarding copyright ownership.
 *
 * This is free software; you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as
 * published by the Free Software Foundation; either version 2.1 of
 * the License, or (at your option) any later version.
 *
 * This software is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this software; if not, write to the Free
 * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
 * 02110-1301 USA, or see the FSF site: http://www.fsf.org.
-->

<xwikidoc version="1.3" reference="XWiki.PDFViewerMacro" locale="">
  <web>XWiki</web>
  <name>PDFViewerMacro</name>
  <language/>
  <defaultLanguage/>
  <translation>0</translation>
  <creator>xwiki:XWiki.Admin</creator>
  <creationDate>1348762397000</creationDate>
  <parent>XWiki.WebHome</parent>
  <author>xwiki:XWiki.Admin</author>
  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>
  <date>1510072670000</date>
  <contentUpdateDate>1510072255000</contentUpdateDate>
  <version>1.1</version>
  <title>PDF Viewer Macro</title>
  <comment/>
  <minorEdit>false</minorEdit>
  <syntaxId>xwiki/2.1</syntaxId>
  <hidden>true</hidden>
  <content>{{pdfviewer file="pdftest.pdf" /}}</content>
  <attachment>
    <filename>pdftest.pdf</filename>
    <author>xwiki:XWiki.Admin</author>
    <date>1510072255000</date>
    <version>1.1</version>
    <comment/>
    <content>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RRsNZW5kc3RyZWFtDWVuZG9iag0xIDAgb2JqDTw8L0xlbmd0aCAzODA3L1N1YnR5cGUvWE1ML1R5cGUvTWV0YWRhdGE+PnN0cmVhbQ0KPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNC4yLjEtYzA0MyA1Mi4zNzI3MjgsIDIwMDkvMDEvMTgtMTU6NTY6MzcgICAgICAgICI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyI+CiAgICAgICAgIDxkYzpmb3JtYXQ+YXBwbGljYXRpb24vcGRmPC9kYzpmb3JtYXQ+CiAgICAgICAgIDxkYzpjcmVhdG9yPgogICAgICAgICAgICA8cmRmOlNlcT4KICAgICAgICAgICAgICAgPHJkZjpsaT5Vbmtub3duPC9yZGY6bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC9kYzpjcmVhdG9yPgogICAgICAgICA8ZGM6ZGVzY3JpcHRpb24+CiAgICAgICAgICAgIDxyZGY6QWx0PgogICAgICAgICAgICAgICA8cmRmOmxpIHhtbDpsYW5nPSJ4LWRlZmF1bHQiLz4KICAgICAgICAgICAgPC9yZGY6QWx0PgogICAgICAgICA8L2RjOmRlc2NyaXB0aW9uPgogICAgICAgICA8ZGM6dGl0bGU+CiAgICAgICAgICAgIDxyZGY6QWx0PgogICAgICAgICAgICAgICA8cmRmOmxpIHhtbDpsYW5nPSJ4LWRlZmF1bHQiPjE3MjUuUERGPC9yZGY6bGk+CiAgICAgICAgICAgIDwvcmRmOkFsdD4KICAgICAgICAgPC9kYzp0aXRsZT4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnBkZj0iaHR0cDovL25zLmFkb2JlLmNvbS9wZGYvMS4zLyI+CiAgICAgICAgIDxwZGY6Q3JlYXRpb25EYXRlLS1UZXh0PjEtSmFuLTMgMTg6MTVQTTwvcGRmOkNyZWF0aW9uRGF0ZS0tVGV4dD4KICAgICAgICAgPHBkZjpLZXl3b3Jkcy8+CiAgICAgICAgIDxwZGY6UHJvZHVjZXI+QWNyb2JhdCBQREZXcml0ZXIgMy4wMiBmb3IgV2luZG93czwvcGRmOlByb2R1Y2VyPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD4xNzI1LmZtPC94bXA6Q3JlYXRvclRvb2w+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4yMDExLTA1LTEzVDIyOjI3OjQwLTAzOjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAgICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxMS0wNS0xM1QyMjoyNzo0MC0wMzowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIj4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+dXVpZDpmNTlhZDFmNS1jZTUyLTVmNGQtOGNlZi0xYjE1YjI3ODMyN2M8L3htcE1NOkRvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpJbnN0YW5jZUlEPnV1aWQ6YTgzM2I4MWQtYzkwZi1mMzRmLWJhYjktN2UwMTU4OWIzNTQ2PC94bXBNTTpJbnN0YW5jZUlEPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3Ij8+DWVuZHN0cmVhbQ1lbmRvYmoNMiAwIG9iag08PC9GaWx0ZXIvRmxhdGVEZWNvZGUvRmlyc3QgMTQvTGVuZ3RoIDE3Mi9OIDMvVHlwZS9PYmpTdG0+PnN0cmVhbQ0KaN6EjssKwjAQRX9lvqCZaR5tQLqwiy5EKEVwEbIIWDRgW2kj2L83qbhw5epw75kLIwFBAVdQgCbY7Vg9PccAxA7+shiiqDvLTuujZ6279ktVGVa7ezO7NR43bhgcYJYLVbLzzYe+nfwYDGZaogQCyrDUZKvKbrOu2X9X5rOCH1h2dGH2rygFV5TaPJcRSFxH8FKmsiCVEuoiJRI8ARWqzQmyf355CzAACCY+Jg1lbmRzdHJlYW0NZW5kb2JqDTMgMCBvYmoNPDwvRmlsdGVyL0ZsYXRlRGVjb2RlL0ZpcnN0IDQvTGVuZ3RoIDE3OC9OIDEvVHlwZS9PYmpTdG0+PnN0cmVhbQ0KaN50zUsLgkAUBeC/MjudxTgPE0NEkKRFIQgZrtUZyR5z4Tpi/fukVi1an3O+syWCpCnPZ3cB9M/2ZmGxlO/QtG4EW7TO+JIdWstCIreJjKryN2WsNk/3p7OSMlZRMDwoP5rXAqgnn/IS9AcuEiWkFJEMlVLxRjARekJ4lFcIeu4N+nmP0LWOVMW+wdEZJGEgFBkASTNaDctE+WnurqZ3q1uP7m6+j+uAZtlbgAEAPklCpA1lbmRzdHJlYW0NZW5kb2JqDTQgMCBvYmoNPDwvRGVjb2RlUGFybXM8PC9Db2x1bW5zIDQvUHJlZGljdG9yIDEyPj4vRmlsdGVyL0ZsYXRlRGVjb2RlL0lEWzw0NzE0OTUxMDQzM0RENDg4MkYwNUY4QzEyNDIyMzczND48RkY2RkZDMjdFRThGNDIzRUIyRTJFQzlDOUNCQTMxQTE+XS9JbmZvIDggMCBSL0xlbmd0aCA0Mi9Sb290IDEwIDAgUi9TaXplIDkvVHlwZS9YUmVmL1dbMSAyIDFdPj5zdHJlYW0NCmjeYmIAAiZGdhkGJgZ+bSDByAki+IBiL5YAWQwMjDCC8R9AgAEALS0DGA1lbmRzdHJlYW0NZW5kb2JqDXN0YXJ0eHJlZg0xMTYNJSVFT0YN</content>
    <filesize>6528</filesize>
  </attachment>
  <object>
    <name>XWiki.PDFViewerMacro</name>
    <number>0</number>
    <className>XWiki.WikiMacroClass</className>
    <guid>c21007eb-5ebe-4048-9081-52d8739c58fb</guid>
    <class>
      <name>XWiki.WikiMacroClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <code>
        <disabled>0</disabled>
        <editor>Text</editor>
        <name>code</name>
        <number>9</number>
        <prettyName>Macro code</prettyName>
        <rows>20</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </code>
      <contentDescription>
        <contenttype>PureText</contenttype>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>contentDescription</name>
        <number>8</number>
        <prettyName>Content description (Not applicable for "No content" type)</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </contentDescription>
      <contentType>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>0</multiSelect>
        <name>contentType</name>
        <number>7</number>
        <prettyName>Macro content type</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator>|</separator>
        <separators>|</separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>Optional|Mandatory|No content</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </contentType>
      <defaultCategory>
        <disabled>0</disabled>
        <name>defaultCategory</name>
        <number>4</number>
        <prettyName>Default category</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultCategory>
      <description>
        <contenttype>PureText</contenttype>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>description</name>
        <number>3</number>
        <prettyName>Macro description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <id>
        <disabled>0</disabled>
        <name>id</name>
        <number>1</number>
        <prettyName>Macro id</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </id>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>2</number>
        <prettyName>Macro name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <supportsInlineMode>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>supportsInlineMode</name>
        <number>5</number>
        <prettyName>Supports inline mode</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </supportsInlineMode>
      <visibility>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>0</multiSelect>
        <name>visibility</name>
        <number>6</number>
        <prettyName>Macro visibility</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator>|</separator>
        <separators>|</separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>Current User|Current Wiki|Global</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </visibility>
    </class>
    <property>
      <code>{{include reference="Licenses.Code.VelocityMacros"/}}

{{velocity output="false"}}
#macro (checkDocumentAsAuthor $documentName)
  #if (!$services.security.authorization.hasAccess('view', $documentName) &amp;&amp; $asAuthor &amp;&amp;
      $xwiki.hasProgrammingRights() &amp;&amp; $xwiki.exists('XWiki.PDFViewerService'))
    #set ($document = $xwiki.getDocumentAsAuthor($documentName))
    #set ($authorRightsNeeded = true)
  #end
#end

#macro (getUrlFromFile $file)
  #set ($url = $NULL)
  ## If the url is not directly specified, the attachment reference can be taken either directly from the file macro
  ## parameter for xwiki versions starting with 11.5, since an attachment picker is used, or by using both the file and
  ## document parameters.
  #if ($file.startsWith('http://') || $file.startsWith('https://'))
    #set ($url = $file)
  #else
    ## For backwards compatibility with the macros added in older versions, first it is checked if the file name
    ## specified exists on the defined document or on the current one before considering the file parameter as the full
    ## reference. The filename is needed for the error message when no attachment is found.
    #set ($filename = $file)
    #set ($authorRightsNeeded = false)
    #if ("$!docname" != '')
      #set ($document = $xwiki.getDocument($docname))
      #checkDocumentAsAuthor($docname)
    #else
      #set ($document = $doc)
    #end
    #set ($attachment = $document.getAttachment($file))
    #if (!$attachment)
      #set ($attachmentReference = $services.model.resolveAttachment($file))
      #set ($filename = $attachmentReference.name)
      #set ($document = $xwiki.getDocument($attachmentReference.parent))
      #checkDocumentAsAuthor($attachmentReference.parent)
      #set ($attachment = $document.getAttachment($filename))
    #end
    #set ($url = $NULL)
    #if ($attachment)
      #if (!$authorRightsNeeded)
        #set ($url = $document.getAttachmentURL($attachment.getFilename()))
      #else
        #set ($digestFactory = $services.component.getInstance('org.xwiki.crypto.DigestFactory', 'SHA-1'))
        #set ($encoder = $services.component.getInstance('org.xwiki.crypto.BinaryStringEncoder', 'URLBase64'))
        #if ($digestFactory &amp;&amp; $encoder)
          #set ($contentAuthor = $services.model.serialize($doc.contentAuthorReference, 'default'))
          #set ($digest = $digestFactory.instance)
          #set ($is = $digest.getInputStream($attachment.contentInputStream))
          #set ($discard = $digest.getInputStream($attachment.contentInputStream).skip(1000))
          #set ($discard = $is.close())
          #if ($xcontext.userReference)
            #set ($discard = $digest.update($services.model.serialize($xcontext.userReference, 'default').getBytes('UTF-8')))
          #end
          #set ($discard = $digest.update($contentAuthor.getBytes('UTF-8')))
          #set ($digest = $encoder.encode($digest.digest))
          #set ($queryString = $escapetool.url({'reference': $services.model.serialize($document.documentReference, 'default'),
                                                'filename': $attachment.filename,
                                                'user': $contentAuthor,
                                                'key': $digest}))
          #set ($url = $xwiki.getDocument('XWiki.PDFViewerService').getExternalURL('get', $queryString))
        #end
      #end
    #end
  #end
#end

#macro(displayFile $file)
  #getUrlFromFile($file)
  #if ($url)
    #set ($pdfViewerConfigDoc = $xwiki.getDocument('PDFViewer.Code.PDFViewerConfiguration'))
    #set ($trustedOrigins = $pdfViewerConfigDoc.getValue('trustedOrigins'))
    #set ($withCredentials = $pdfViewerConfigDoc.getValue('withCredentials'))
    #set ($trustedOrigins = $stringtool.join($trustedOrigins.split('\r\n'), ','))
    #set ($queryString = $escapetool.url({
      'file': $url,
      'trustedOrigins': $trustedOrigins,
      'withCredentials': $withCredentials
    }))
    #set ($pdfviewerurl = $xwiki.getDocument('XWiki.PDFViewerMacro').getAttachmentURL('pdfviewer.zip'))
    ## Attachment URL have query parameters for cache issue.
    #set ($pdfviewerurl = $pdfviewerurl.split('\?')[0])
    {{html clean=false}}
      &lt;div&gt;
      &lt;!--[if lt IE 10]&gt;
        &lt;div class="box warningmessage"&gt;PDF Viewer : Not compatible with IE &lt; 10&lt;/div&gt;
      &lt;![endif]--&gt;
      &lt;![if !(lt IE 10)]&gt;
        &lt;iframe src="${pdfviewerurl}/pdf-viewer/web/viewer.html?${queryString}#locale=${xcontext.locale}" width="${width}" height="${height}"&gt;&lt;/iframe&gt;
      &lt;![endif]--&gt;
      &lt;/div&gt;
    {{/html}}
  #elseif (!$document || $document.isNew())
    {{error}}$services.localization.render('pdfviewer.error.nodocument', [$escapetool.html($escapetool.html($docname))]){{/error}}
  #else
    {{error}}$services.localization.render('pdfviewer.error.noattachment', [$escapetool.html($filename), $escapetool.html($services.model.serialize($document.documentReference, 'default'))]){{/error}}
  #end
#end

#macro(isActive)
  #set ($activeClass = $NULL)
  #set ($isActive = $request.file == $file)
  #if ("$!request.file" == '')
    #set ($isActive = $foreach.index == 0)
  #end
#end
{{/velocity}}

{{velocity}}
#set ($mainPageReference = $services.model.createDocumentReference('', ['XWiki'], 'PDFViewerService'))
#if (!$services.licensing.licensor.hasLicensureForEntity($mainPageReference))
  {{error}}#getMissingLicenseMessage('pdfviewer.extension.name'){{/error}}
#else
  #set ($width = $xcontext.macro.params.width)
  #set ($height = $xcontext.macro.params.height)
  #set ($fileParam = $xcontext.macro.params.file)
  #set ($docname = $xcontext.macro.params.document)
  #set ($asAuthor = $xcontext.macro.params.asauthor &amp;&amp; ($xcontext.macro.params.asauthor == 'true' || $xcontext.macro.params.asauthor == 'yes' || $xcontext.macro.params.asauthor == '1'))
  #if (!$fileParam)
    {{error}}$services.localization.render('pdfviewer.error.nofile'){{/error}}
  #else
    #set ($files = $fileParam.split(','))
    #if ($files.size() == 1)
      #displayFile($files[0])
    #else
      ## Display each PDF file in its own tab, in the page content.
      ##===========
      ## Display the Tabs
      ##===========
      {{html clean="false"}}
      &lt;div class="floatcontainer"&gt;
        &lt;ul class="xwikitabbar"&gt;
        #foreach ($file in $files)
          #isActive
          #if ($isActive)
            #set ($activeClass = "class='active'")
          #end
          &lt;li id="$escapetool.xml($file)" $activeClass&gt;
            &lt;a href="$doc.getURL('view', "file=$escapetool.url($file)")"&gt;$file&lt;/a&gt;
          &lt;/li&gt;
        #end
        &lt;/ul&gt;
      &lt;/div&gt;
      {{/html}}
      ##==========================
      ## Include the Tab data for the selected Tab
      ##==========================
      {{html clean="false" wiki="true"}}
      &lt;div class='xwikitabpanescontainer'&gt;
      #foreach ($file in $files)
        #isActive
        #if ($isActive)
          #displayFile($file)
          #break
        #end
      #end
      &lt;/div&gt;
      {{/html}}
    #end
  #end
#end
{{/velocity}}</code>
    </property>
    <property>
      <contentDescription/>
    </property>
    <property>
      <contentType>No content</contentType>
    </property>
    <property>
      <defaultCategory>Content</defaultCategory>
    </property>
    <property>
      <description>PDF Viewer based on Mozilla pdf.js</description>
    </property>
    <property>
      <id>pdfviewer</id>
    </property>
    <property>
      <name>pdfviewer</name>
    </property>
    <property>
      <supportsInlineMode>0</supportsInlineMode>
    </property>
    <property>
      <visibility>Current Wiki</visibility>
    </property>
  </object>
  <object>
    <name>XWiki.PDFViewerMacro</name>
    <number>0</number>
    <className>XWiki.WikiMacroParameterClass</className>
    <guid>2ca63cd8-423e-49aa-bf53-84a201c41d2d</guid>
    <class>
      <name>XWiki.WikiMacroParameterClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <defaultValue>
        <disabled>0</disabled>
        <name>defaultValue</name>
        <number>4</number>
        <prettyName>Parameter default value</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultValue>
      <description>
        <disabled>0</disabled>
        <name>description</name>
        <number>2</number>
        <prettyName>Parameter description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <mandatory>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>mandatory</name>
        <number>3</number>
        <prettyName>Parameter mandatory</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </mandatory>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Parameter name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <type>
        <disabled>0</disabled>
        <name>type</name>
        <number>5</number>
        <prettyName>Parameter type</prettyName>
        <size>60</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </type>
    </class>
    <property>
      <defaultValue/>
    </property>
    <property>
      <description>File or URL path to the PDF file</description>
    </property>
    <property>
      <mandatory>1</mandatory>
    </property>
    <property>
      <name>file</name>
    </property>
    <property>
      <type>com.xwiki.pdfviewer.PDFResourceReference</type>
    </property>
  </object>
  <object>
    <name>XWiki.PDFViewerMacro</name>
    <number>1</number>
    <className>XWiki.WikiMacroParameterClass</className>
    <guid>94db3764-f00a-486a-bbde-48057fff65b1</guid>
    <class>
      <name>XWiki.WikiMacroParameterClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <defaultValue>
        <disabled>0</disabled>
        <name>defaultValue</name>
        <number>4</number>
        <prettyName>Parameter default value</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultValue>
      <description>
        <disabled>0</disabled>
        <name>description</name>
        <number>2</number>
        <prettyName>Parameter description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <mandatory>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>mandatory</name>
        <number>3</number>
        <prettyName>Parameter mandatory</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </mandatory>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Parameter name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <type>
        <disabled>0</disabled>
        <name>type</name>
        <number>5</number>
        <prettyName>Parameter type</prettyName>
        <size>60</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </type>
    </class>
    <property>
      <defaultValue/>
    </property>
    <property>
      <description>Reference of the document containing the file (not used if file is a URL)</description>
    </property>
    <property>
      <mandatory/>
    </property>
    <property>
      <name>document</name>
    </property>
  </object>
  <object>
    <name>XWiki.PDFViewerMacro</name>
    <number>2</number>
    <className>XWiki.WikiMacroParameterClass</className>
    <guid>90e37db1-ed7b-4b65-82d6-4e3678a0dd58</guid>
    <class>
      <name>XWiki.WikiMacroParameterClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <defaultValue>
        <disabled>0</disabled>
        <name>defaultValue</name>
        <number>4</number>
        <prettyName>Parameter default value</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultValue>
      <description>
        <disabled>0</disabled>
        <name>description</name>
        <number>2</number>
        <prettyName>Parameter description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <mandatory>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>mandatory</name>
        <number>3</number>
        <prettyName>Parameter mandatory</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </mandatory>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Parameter name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <type>
        <disabled>0</disabled>
        <name>type</name>
        <number>5</number>
        <prettyName>Parameter type</prettyName>
        <size>60</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </type>
    </class>
    <property>
      <defaultValue>100%</defaultValue>
    </property>
    <property>
      <description/>
    </property>
    <property>
      <mandatory/>
    </property>
    <property>
      <name>width</name>
    </property>
  </object>
  <object>
    <name>XWiki.PDFViewerMacro</name>
    <number>3</number>
    <className>XWiki.WikiMacroParameterClass</className>
    <guid>80e795a9-da2d-4f3e-8732-1d3efb97b4a0</guid>
    <class>
      <name>XWiki.WikiMacroParameterClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <defaultValue>
        <disabled>0</disabled>
        <name>defaultValue</name>
        <number>4</number>
        <prettyName>Parameter default value</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultValue>
      <description>
        <disabled>0</disabled>
        <name>description</name>
        <number>2</number>
        <prettyName>Parameter description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <mandatory>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>mandatory</name>
        <number>3</number>
        <prettyName>Parameter mandatory</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </mandatory>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Parameter name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <type>
        <disabled>0</disabled>
        <name>type</name>
        <number>5</number>
        <prettyName>Parameter type</prettyName>
        <size>60</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </type>
    </class>
    <property>
      <defaultValue>1000</defaultValue>
    </property>
    <property>
      <description/>
    </property>
    <property>
      <mandatory/>
    </property>
    <property>
      <name>height</name>
    </property>
  </object>
  <object>
    <name>XWiki.PDFViewerMacro</name>
    <number>4</number>
    <className>XWiki.WikiMacroParameterClass</className>
    <guid>71393ffb-5ae1-4257-acc6-b20371e6313d</guid>
    <class>
      <name>XWiki.WikiMacroParameterClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <defaultValue>
        <disabled>0</disabled>
        <name>defaultValue</name>
        <number>4</number>
        <prettyName>Parameter default value</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultValue>
      <description>
        <disabled>0</disabled>
        <name>description</name>
        <number>2</number>
        <prettyName>Parameter description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <mandatory>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>mandatory</name>
        <number>3</number>
        <prettyName>Parameter mandatory</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </mandatory>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Parameter name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <type>
        <disabled>0</disabled>
        <name>type</name>
        <number>5</number>
        <prettyName>Parameter type</prettyName>
        <size>60</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </type>
    </class>
    <property>
      <defaultValue>0</defaultValue>
    </property>
    <property>
      <description>If this value is true (or 1 or yes) and the user has no access to the  document to which the PDF file is attached, the PDF file could still be viewed on behalf of the author of the document containing the macro (if that author has access to the containing document obviously).</description>
    </property>
    <property>
      <mandatory/>
    </property>
    <property>
      <name>asauthor</name>
    </property>
  </object>
</xwikidoc>
